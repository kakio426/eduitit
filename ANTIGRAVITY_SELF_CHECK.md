# **Antigravity Self-Verification Protocol (ASVP)**

이 문서는 Antigravity 에이전트가 코드를 완성하고 사용자에게 제출하기 전, 스스로 품질을 검증하기 위한 **최종 체크리스트**입니다. 2026년 2월 9일 체스 업그레이드 작업에서 발생한 중대 과실들을 바탕으로 작성되었습니다.

---

## **1. 상태 관리 및 동기화 (State & Sync)**
- [ ] **상태 역행(Undo) 완결성**: `undo` 기능 구현 시, 라이브러리 상태(e.g. `game.undo()`)뿐만 아니라 내가 추가한 모든 커스텀 UI 상태(`capturedPieces`, `lastMove`, `highlights`)를 역방향으로 동기화했는가?
- [ ] **초기화(Reset) 시각화**: 데이터 구조만 초기화하지 않고, 실제 DOM이나 UI 컴포넌트에 즉시 반영(`render()` 함수 호출 등)했는가?
- [ ] **데이터 일관성**: 저장된 기록(`moveHistory`)과 화면에 표시된 정보가 항상 일치하는가?

## **2. 자바스크립트 표준 및 스코프 (JS Standard)**
- [ ] **Anti-var Policy**: 절대 `var`를 사용하지 않는다. 반드시 `let` 또는 `const`를 사용한다.
- [ ] **섀도잉(Shadowing) 금지**: 동일 함수 내에서 변수명을 재사용하여 이전 분기의 값을 덮어쓰는 실수를 하지 않았는가?
- [ ] **비동기 안전성**: `setTimeout`이나 `Worker` 통신 시, 상태가 변한 후(이전으로 되돌린 후)에 콜백이 실행되어 상태가 꼬이는 경우는 없는가?

## **3. 자원 및 성능 관리 (Resource & Perf)**
- [ ] **싱글톤 패턴**: `AudioContext`, `Web Worker` 등 생성 비용이 큰 객체는 전역/공유 컨텍스트를 사용하는가? (과도 생성 금지)
- [ ] **자원 해제**: 사용이 끝난 이벤트 리스너나 타이머가 메모리 누수를 일으키진 않는가?

## **4. UI/UX 정합성 및 디테일 (Visual Integrity)**
- [ ] **설명과 구현의 일치**: 사용자에게 제공하는 매뉴얼/텍스트(e.g. "드래그")와 실제 조작 방식(e.g. "클릭")이 일치하는가?
- [ ] **시각적 로직 피드백**: 프로모션 기물의 색상, 킹의 위치 표시 등 상황에 맞는 정확한 에셋을 선택했는가?
- [ ] **애니메이션 완결성**: `animation` 속성을 썼다면 대응하는 `@keyframes`가 반드시 같은 파일이나 base 파일에 정의되어 있는가?
- [ ] **모바일 대응**: 가장 작은 화면(320px)에서 버튼이나 모달이 겹치거나 잘리지 않는가?

## **5. 환경 격리 및 정리 (Cleanup)**
- [ ] **불필요한 파일 제거**: 작업 영역(static, templates 등)에 다른 앱에서 온 임시 파일이나 스크린샷이 남아있지 않은가?
- [ ] **디버그 코드 제거**: `console.log`나 테스트용 하드코딩 값이 남아있지 않은가?

---

## **명령어 (준수 여부 확인용)**
- [ ] `grep -r "var " .` (JS 파일에서 var 사용 여부 체크)
- [ ] `grep -r "console.log" .` (디버그 로그 체크)

---
**"동작하게 만드는 것은 시작일 뿐이다. 완벽하게 상태를 관리하고 자원을 배려하는 것이 전문성이다."**
