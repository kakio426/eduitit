{% extends "base.html" %}

{% block title %}동의서 생성 3단계{% endblock %}

{% block content %}
<main class="pt-32 pb-16 px-4 min-h-screen">
  <div class="max-w-6xl mx-auto">
    <div class="mb-6">
      <a href="{% url 'consent:setup_positions' request_id=consent_request.request_id %}" class="text-sm text-gray-500 hover:text-purple-600">이전 단계로</a>
      <h1 class="text-3xl font-bold text-gray-800 mt-2">3단계. 수신자 등록</h1>
      <p class="text-sm text-gray-500 mt-1">등록 후 상세 화면에서 미리보기 확인 및 발송하세요.</p>
    </div>

    <div class="grid lg:grid-cols-2 gap-4">
      <section class="bg-white border border-gray-200 rounded-2xl p-5">
        <h2 class="text-lg font-bold mb-3">수신자 일괄 등록</h2>
        <form method="post" class="space-y-3">
          {% csrf_token %}
          <p class="text-sm text-gray-500">형식: 학생명,학부모명,전화번호</p>
          {{ form.recipients_text }}
          <button type="submit" class="px-4 py-2 rounded-xl bg-purple-600 text-white font-semibold hover:bg-purple-700">등록</button>
          <a href="{% url 'consent:detail' request_id=consent_request.request_id %}" class="ml-2 px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm">상세로 이동</a>
        </form>
      </section>

      <section class="bg-white border border-gray-200 rounded-2xl p-5">
        <h2 class="text-lg font-bold mb-3">현재 등록 목록</h2>
        <div class="max-h-80 overflow-auto border rounded-xl">
          <table class="w-full text-sm">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-3 py-2 text-left">학생</th>
                <th class="px-3 py-2 text-left">학부모</th>
                <th class="px-3 py-2 text-left">전화번호</th>
              </tr>
            </thead>
            <tbody>
              {% for r in recipients %}
              <tr class="border-t">
                <td class="px-3 py-2">{{ r.student_name }}</td>
                <td class="px-3 py-2">{{ r.parent_name }}</td>
                <td class="px-3 py-2">{{ r.phone_number }}</td>
              </tr>
              {% empty %}
              <tr><td colspan="3" class="px-3 py-8 text-center text-gray-400">아직 수신자가 없습니다.</td></tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </div>
</main>
{% endblock %}
