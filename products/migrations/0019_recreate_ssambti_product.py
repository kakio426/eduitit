# Generated by Django 6.0.1 on 2026-01-30 14:50

from django.db import migrations


def recreate_ssambti_product(apps, schema_editor):
    """
    Recreate Ssambti product with correct settings.
    This fixes the external_url issue from migration 0018.
    """
    Product = apps.get_model('products', 'Product')

    # Delete old version if exists (may have wrong external_url from 0018)
    Product.objects.filter(title='ìŒ¤BTI').delete()

    # Create fresh Ssambti product with correct settings
    Product.objects.create(
        title='ìŒ¤BTI',
        lead_text='ë‚˜ëŠ” ì–´ë–¤ ì„ ìƒë‹˜ì¼ê¹Œ? ğŸ¦',
        description='12ê°€ì§€ ì§ˆë¬¸ìœ¼ë¡œ ì•Œì•„ë³´ëŠ” ë‚˜ì˜ êµìœ¡ ìŠ¤íƒ€ì¼! MBTI ê¸°ë°˜ í‹°ì²˜ë¸” ë™ë¬¼ì›ì—ì„œ ë‚˜ì™€ ë‹®ì€ ë™ë¬¼ì„ ì°¾ì•„ë³´ì„¸ìš”.',
        price=0.00,
        is_active=True,
        is_featured=False,
        is_guest_allowed=True,
        icon='ğŸ¦',
        color_theme='orange',
        card_size='small',
        display_order=13,  # After AI í”„ë¡¬í”„íŠ¸ ë ˆì‹œí”¼ (12)
        service_type='game',
        external_url='',  # CRITICAL FIX: Empty for internal service
    )
    print("[OK] Ssambti product recreated successfully with correct settings!")


def reverse_recreate(apps, schema_editor):
    """Reverse migration: delete Ssambti product"""
    Product = apps.get_model('products', 'Product')
    Product.objects.filter(title='ìŒ¤BTI').delete()
    print("[OK] Ssambti product deleted.")


class Migration(migrations.Migration):

    dependencies = [
        ('products', '0018_add_ssambti_product'),
    ]

    operations = [
        migrations.RunPython(recreate_ssambti_product, reverse_recreate),
    ]
