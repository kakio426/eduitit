{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<style>
    /* Animation for results */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in-up {
        animation: fadeInUp 0.8s ease-out forwards;
    }

    /* Badges for AI Result */
    .badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-weight: bold;
        font-size: 0.875rem;
        box-shadow: inset 2px 2px 4px rgba(0, 0, 0, 0.05), inset -2px -2px 4px rgba(255, 255, 255, 0.8);
    }

    .badge-orange {
        background-color: #ffedd5;
        color: #c2410c;
    }

    .badge-purple {
        background-color: #f3e8ff;
        color: #7e22ce;
    }

    .badge-green {
        background-color: #dcfce7;
        color: #15803d;
    }
</style>
{% endblock %}

{% block content %}
<section class="pt-32 pb-20 px-6 min-h-screen bg-[#E0E5EC]">
    <div class="max-w-4xl mx-auto space-y-8 animate-fade-in-up">

        <!-- Navigation -->
        <div class="flex justify-between items-center px-2">
            <a href="{% url 'fortune:zoo_history' %}"
                class="inline-flex items-center gap-2 text-gray-500 hover:text-orange-500 transition font-bold">
                <i class="fa-solid fa-arrow-left"></i> ë³´ê´€í•¨ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            </a>
            <span class="text-gray-400 font-hand">{{ result.created_at|date:"Y.m.d" }} ë¶„ì„</span>
        </div>

        <!-- 1. í—¤ë” ì¹´ë“œ (ë™ë¬¼ ì´ë¯¸ì§€ & íƒ€ì´í‹€) -->
        <div class="clay-card p-10 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-orange-300 to-orange-500"></div>

            <div class="inline-block p-2 rounded-full bg-white shadow-clay-inner mb-6 relative z-10">
                <img src="{% static 'fortune/images/zoo/' %}{{ animal_image }}" alt="{{ result.animal_name }}"
                    class="w-48 h-48 object-cover rounded-full">
            </div>

            <h2 class="text-4xl md:text-5xl font-bold text-gray-800 font-title mb-3">
                <span class="text-orange-500 block text-2xl mb-2 font-hand">êµì‹¤ ì† ë‹¹ì‹ ì˜ ì˜í˜¼ì€</span>
                {{ result.animal_name }}
            </h2>
        </div>

        <!-- 2. AI ë¶„ì„ ë‚´ìš© -->
        <div class="zoo-result-content">
            {{ result.result_text|safe }}
        </div>

        <!-- 3. ê³µìœ  ì•¡ì…˜ ì¹´ë“œ -->
        <div class="clay-card p-8 bg-white/50 border border-white/60 text-center">
            <h3 class="text-2xl font-bold text-gray-700 mb-6 font-title">
                ë™ë£Œ ì„ ìƒë‹˜ë“¤ì—ê²Œë„ ì•Œë ¤ì£¼ì„¸ìš”! ğŸ“¢
            </h3>
            <div class="flex flex-col md:flex-row gap-4 justify-center">
                <button onclick="shareToKakao()"
                    class="px-8 py-4 bg-[#FEE500] text-[#3C1E1E] rounded-full font-bold flex items-center justify-center gap-2 hover:scale-105 transition shadow-clay text-lg">
                    <i class="fa-solid fa-comment"></i> ì¹´ì¹´ì˜¤í†¡ ê³µìœ 
                </button>
                <button onclick="copyLink()"
                    class="px-8 py-4 bg-white text-gray-600 rounded-full font-bold flex items-center justify-center gap-2 hover:scale-105 transition shadow-clay border border-gray-100 text-lg">
                    <i class="fa-solid fa-link"></i> ë§í¬ ë³µì‚¬
                </button>
                <a href="{% url 'fortune:zoo_main' %}"
                    class="px-8 py-4 bg-orange-500 text-white rounded-full font-bold flex items-center justify-center gap-2 hover:scale-105 transition shadow-clay text-lg">
                    <i class="fa-solid fa-rotate-right"></i> ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Kakao SDK -->
<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js"></script>
<script>
    if (typeof Kakao !== 'undefined' && !Kakao.isInitialized()) {
        Kakao.init('{{ KAKAO_JS_KEY }}');
    }

    function shareToKakao() {
        Kakao.Share.sendDefault({
            objectType: 'feed',
            content: {
                title: 'ë‚˜ì˜ êµì‹¤ ì† ì˜í˜¼ì˜ ë™ë¬¼ì€?',
                description: 'ë‚˜ëŠ” [{{ result.animal_name }}] ì„ ìƒë‹˜ì…ë‹ˆë‹¤! ë‹¹ì‹ ì˜ ë™ë¬¼ì€ ë¬´ì—‡ì¸ê°€ìš”?',
                imageUrl: 'https://{{ request.get_host }}{% static "fortune/images/zoo/share_thumb.png" %}',
                link: {
                    mobileWebUrl: window.location.href,
                    webUrl: window.location.href,
                },
            },
            buttons: [
                {
                    title: 'ë‚˜ë„ í…ŒìŠ¤íŠ¸í•´ë³´ê¸°',
                    link: {
                        mobileWebUrl: 'https://{{ request.get_host }}{% url "fortune:zoo_main" %}',
                        webUrl: 'https://{{ request.get_host }}{% url "fortune:zoo_main" %}',
                    },
                },
            ],
        });
    }

    function copyLink() {
        const url = window.location.href;
        navigator.clipboard.writeText(url).then(() => {
            alert('ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
        });
    }
</script>
{% endblock %}