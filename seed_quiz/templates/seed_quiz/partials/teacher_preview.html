<div class="clay-card p-6 rounded-2xl">
    {% if rag_notice %}
    <div class="mb-4 px-4 py-3 bg-indigo-50 border border-indigo-200 rounded-xl text-sm text-indigo-700 font-medium">
        {{ rag_notice }}
    </div>
    {% endif %}
    <div class="flex items-start justify-between gap-3 mb-4">
        <div>
            <h2 class="font-bold text-gray-700">2) μ €μ¥λ λ¬Έμ  ν™•μΈ</h2>
            <p class="text-xs text-gray-500 mt-1">
                μ¶μ²: {% if quiz_set.source == 'bank' %}ν€΄μ¦ μ€ν–‰{% elif quiz_set.source == 'csv' %}CSV{% elif quiz_set.source == 'fallback' %}κΈ°λ³Έ λ¬Έμ {% else %}AI{% endif %}
            </p>
            <p class="text-xs text-gray-500 mt-1">λ¬Έμ κ°€ λ§μΌλ©΄ μ•„λ λ²„νΌμΌλ΅ λ°”λ΅ μ΄μν•μ„Έμ”.</p>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-2 mb-2">
        <form hx-post="{% url 'seed_quiz:htmx_publish' classroom_id=classroom.id set_id=quiz_set.id %}"
              hx-target="#preview-area"
              hx-swap="innerHTML"
              hx-indicator="#preview-publish-indicator"
              hx-disabled-elt="button"
              class="w-full">
            {% csrf_token %}
            <button type="submit"
                    data-seed-quiz-publish-button
                    data-seed-quiz-action="publish"
                    class="inline-flex items-center justify-center w-full px-4 py-2.5 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg text-sm font-bold hover:shadow-md transition-all whitespace-nowrap min-h-[44px]">
                <span id="preview-publish-indicator" class="htmx-indicator mr-1 text-xs">β³</span>
                ν•™μƒμ—κ² λ°°ν¬ν•κΈ°
            </button>
        </form>

        <button type="button"
                hx-get="{% url 'seed_quiz:htmx_bank_browse' classroom_id=classroom.id %}"
                hx-include="#bank-filter-form"
                hx-target="#bank-area"
                hx-swap="innerHTML"
                hx-indicator="#preview-bank-indicator"
                hx-disabled-elt="this"
                data-seed-quiz-action="open-bank"
                data-seed-quiz-open-bank
                class="inline-flex items-center justify-center w-full px-4 py-2.5 bg-gray-100 text-gray-700 rounded-lg text-sm font-bold hover:bg-gray-200 transition-colors whitespace-nowrap min-h-[44px]">
            <span id="preview-bank-indicator" class="htmx-indicator mr-1 text-xs">β³</span>
            λ‹¤λ¥Έ μ„ΈνΈ κ³ λ¥΄κΈ°
        </button>

        <form hx-post="{% url 'seed_quiz:htmx_set_archive' classroom_id=classroom.id set_id=quiz_set.id %}"
              hx-target="#preview-area"
              hx-swap="innerHTML"
              hx-indicator="#preview-archive-indicator"
              hx-disabled-elt="button"
              class="w-full">
            {% csrf_token %}
            <button type="submit"
                    data-seed-quiz-action="archive"
                    class="inline-flex items-center justify-center w-full px-4 py-2.5 bg-amber-100 text-amber-800 rounded-lg text-sm font-bold hover:bg-amber-200 transition-colors whitespace-nowrap min-h-[44px]">
                <span id="preview-archive-indicator" class="htmx-indicator mr-1 text-xs">β³</span>
                μ„ΈνΈ λ³΄κ΄€(μ¨κΉ€)
            </button>
        </form>
    </div>
    <p class="mb-6 text-xs text-gray-500">
        <strong>ν•™μƒμ—κ² λ°°ν¬ν•κΈ°</strong>λ¥Ό λ„λ¥΄λ©΄ μ΄ μμ—­μ΄ λ°°ν¬ μ™„λ£ ν™”λ©΄μΌλ΅ λ°”λ€λ‹λ‹¤.
        <span class="block mt-1"><strong>λ‹¤λ¥Έ μ„ΈνΈ κ³ λ¥΄κΈ°</strong>λ¥Ό λ„λ¥΄λ©΄ μ•„λ ν€΄μ¦ μ€ν–‰ λ©λ΅μΌλ΅ μ΄λ™ν•΄ λ°”λ΅ λ‹¤μ μ„ νƒ λ²„νΌμ— ν¬μ»¤μ¤λ©λ‹λ‹¤.</span>
    </p>

    <div class="space-y-5 mb-6">
        {% for item in items %}
        <div class="p-4 bg-gray-50 rounded-xl">
            <div class="flex items-center gap-2 mb-2">
                <span class="text-xs font-bold px-2 py-0.5 bg-purple-100 text-purple-600 rounded-full">{{ item.order_no }}λ²</span>
                <span class="text-xs text-gray-400">{{ item.difficulty }}</span>
            </div>
            <p class="font-bold text-gray-800 mb-3 leading-snug" style="word-break:keep-all">{{ item.question_text }}</p>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 mb-3">
                {% for choice in item.choices %}
                <div class="px-3 py-2 rounded-lg text-sm {% if forloop.counter0 == item.correct_index %}bg-green-100 border border-green-300 text-green-800 font-bold{% else %}bg-white border border-gray-200 text-gray-600{% endif %}">
                    {% if forloop.counter0 == item.correct_index %}β“ {% endif %}{{ choice }}
                </div>
                {% endfor %}
            </div>
            {% if item.explanation %}
            <p class="text-xs text-gray-500 bg-blue-50 px-3 py-2 rounded-lg">π’΅ {{ item.explanation }}</p>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
