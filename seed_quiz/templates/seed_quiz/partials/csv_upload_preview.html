<div class="p-4 rounded-xl border border-indigo-200 bg-indigo-50 text-slate-700 text-sm"
     hx-on::after-settle="document.body.dispatchEvent(new Event('csvHistoryUpdated'));">
    <p class="font-bold text-indigo-700">CSV 미리보기 완료</p>
    <p class="mt-1">저장 예정 세트: {{ set_count }}개</p>

    <div class="mt-3 space-y-2 max-h-48 overflow-y-auto pr-1">
        {% for s in parsed_sets %}
        <div class="px-3 py-2 bg-white border border-indigo-100 rounded-lg">
            <div class="font-bold text-slate-800">{{ s.set_title }}</div>
            <div class="text-xs text-slate-500 mt-1">
                {{ s.grade }}학년 · {{ s.preset_label|default:s.preset_type }} ({{ s.preset_type }}) · {{ s.items|length }}문항
            </div>
        </div>
        {% endfor %}
    </div>

    <form class="mt-4"
          hx-post="{% url 'seed_quiz:htmx_csv_confirm' classroom_id=classroom.id %}"
          hx-target="#csv-upload-result"
          hx-swap="innerHTML">
        {% csrf_token %}
        <input type="hidden" name="preview_token" value="{{ preview_token }}">
        <label class="inline-flex items-start gap-2 text-xs text-slate-600">
            <input type="checkbox" name="share_opt_in" class="mt-0.5">
            <span>다른 선생님에게 공개 공유 신청하기 (관리자 승인 후 공개)</span>
        </label>
        <div class="mt-3 flex gap-2">
            <button type="submit"
                    class="px-4 py-2 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-lg text-xs font-bold hover:shadow-md transition-all">
                확인 후 저장
            </button>
        </div>
    </form>
</div>
