{% extends 'base.html' %}

{% block content %}
<section class="pt-32 pb-20 px-4 min-h-screen">
    <div class="max-w-4xl mx-auto">

        <div class="mb-8">
            <a href="{% url 'happy_seed:classroom_detail' classroom_id=classroom.id %}" class="text-sm text-gray-400 hover:text-gray-600">&larr; {{ classroom.name }}</a>
        </div>

        <h1 class="text-2xl font-bold text-gray-800 mb-2">ğŸŒ¸ ê½ƒí”¼ì›€ ì¶”ì²¨</h1>
        <p class="text-sm text-gray-500 mb-6 break-keep">ë¸”ë£¸ í‹°ì¼“ì„ ë³´ìœ í•œ í•™ìƒ ëª©ë¡ì…ë‹ˆë‹¤. í•™ìƒì„ ì„ íƒí•˜ì—¬ ì¶”ì²¨ì„ ì‹¤í–‰í•˜ì„¸ìš”.</p>

        {% if students %}
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
            {% for student in students %}
            <div class="clay-card p-5 rounded-2xl text-center" x-data="{ confirming: false }">
                <div class="text-3xl mb-2">ğŸŒ¸</div>
                <div class="font-bold text-gray-800 text-lg">{{ student.name }}</div>
                <div class="text-sm text-gray-500 mt-1">{{ student.number }}ë²ˆ</div>
                <div class="flex items-center justify-center gap-2 mt-2">
                    <span class="text-xs px-2 py-1 bg-pink-100 text-pink-700 rounded-full">í‹°ì¼“ {{ student.ticket_count }}ì¥</span>
                    <span class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full">ì”¨ì•— {{ student.seed_count }}ê°œ</span>
                </div>

                <div x-show="!confirming" class="mt-4">
                    <button @click="confirming = true"
                            class="w-full py-2.5 bg-gradient-to-r from-pink-500 to-rose-500 text-white rounded-xl font-bold text-sm hover:shadow-lg transition-all">
                        ì¶”ì²¨í•˜ê¸°
                    </button>
                </div>
                <div x-show="confirming" x-transition class="mt-4 space-y-2">
                    <p class="text-xs text-gray-500">ì •ë§ ì¶”ì²¨í• ê¹Œìš”?</p>
                    <form method="post" action="{% url 'happy_seed:bloom_draw' student_id=student.id %}" class="flex gap-2">
                        {% csrf_token %}
                        <input type="hidden" name="request_id" value="{{ student.id }}">
                        <button type="button" @click="confirming = false" class="flex-1 py-2 bg-gray-100 text-gray-600 rounded-xl text-sm font-bold">ì·¨ì†Œ</button>
                        <button type="submit" class="flex-1 py-2 bg-pink-500 text-white rounded-xl text-sm font-bold hover:bg-pink-600">í™•ì¸</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="clay-card p-12 rounded-2xl text-center">
            <div class="text-5xl mb-4">ğŸŒ°</div>
            <p class="text-gray-500 break-keep">ë¸”ë£¸ í‹°ì¼“ì„ ë³´ìœ í•œ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.<br>ë¨¼ì € í•™ìƒì—ê²Œ í‹°ì¼“ì„ ë¶€ì—¬í•´ì£¼ì„¸ìš”.</p>
            <a href="{% url 'happy_seed:classroom_detail' classroom_id=classroom.id %}" class="inline-block mt-4 px-6 py-2.5 bg-green-500 text-white rounded-xl font-bold text-sm hover:bg-green-600">êµì‹¤ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
        {% endif %}

    </div>
</section>
{% endblock %}
