{% extends 'base.html' %}

{% block title %}Eduitit - 선생님의 스마트한 하루{% endblock %}

{% block content %}
<!-- URL Definitions -->
{% url 'yut_game' as yut_url %}
{% url 'prompt_lab' as prompt_lab_url %}
{% url 'tool_guide' as tool_guide_url %}

<!-- Main Content -->
<main class="pt-32 pb-20 px-4 md:px-8 min-h-screen max-w-7xl mx-auto">

    <!-- Header -->
    <div class="mb-16 text-center" data-aos="fade-down" data-aos-duration="1000">
        <h1 class="text-7xl md:text-9xl font-bold text-gray-700 mb-2 tracking-tight leading-none text-shadow">
            선생님의 <span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-blue-500">디지털 비서</span>
        </h1>
        <p class="text-3xl md:text-4xl text-gray-400 font-hand max-w-3xl mx-auto mt-4 leading-relaxed">
            설치 없이, 더 똑똑하게. 수업 준비부터 행정 업무까지<br>
            가장 스마트한 AI 도구들을 만나보세요.
        </p>
    </div>

    <!-- BENTO GRID -->
    <div class="bento-grid">

        <!-- 1. [Hero Card] Dynamic Featured Product -->
        <div class="md:col-span-2 md:row-span-2" data-aos="fade-up" data-aos-delay="100">
            <div class="clay-card p-10 h-full relative overflow-hidden group cursor-pointer bg-[#E0E5EC] focus:ring-4 focus:ring-purple-300 focus:outline-none rounded-3xl product-card"
                role="button" tabindex="0" data-product-id="{{ featured_product.id }}"
                data-external-url="{{ featured_product.external_url|default:'' }}">

                <!-- Background decoration -->
                <div
                    class="absolute top-0 right-0 w-80 h-80 bg-purple-100 rounded-bl-full -mr-20 -mt-20 transition-transform duration-500 group-hover:scale-125 z-0">
                </div>

                <div class="relative z-10 h-full flex flex-col justify-between">
                    <div>
                        <span
                            class="px-4 py-1 bg-purple-200 text-purple-700 rounded-full text-xl font-bold shadow-sm mb-6 inline-block">BEST
                            Popular</span>
                        <h2 class="text-6xl font-bold text-gray-700 mb-2 group-hover:text-purple-600 transition-colors">
                            {{ featured_product.title }}
                        </h2>
                        <p class="text-3xl text-gray-500 font-hand leading-tight">{{
                            featured_product.lead_text|default:featured_product.description|truncatechars:80 }}</p>
                    </div>

                    <div class="flex justify-between items-end mt-8">
                        <div class="text-8xl float-icon">
                            {% if "fa-" in featured_product.icon %}
                            <i class="{{ featured_product.icon }}"></i>
                            {% else %}
                            {{ featured_product.icon }}
                            {% endif %}
                        </div>
                        <div
                            class="w-16 h-16 rounded-full bg-purple-500 text-white shadow-lg flex items-center justify-center text-3xl group-hover:rotate-45 transition-transform duration-300">
                            <i class="fa-solid fa-arrow-right"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- 2. [Dynamic Product Cards] All Active Products -->
        {% for product in products %}
        {% if product.id != featured_product.id %}

        {% if product.card_size == "wide" %}
        <!-- Wide Card (2 columns) -->
        <div class="md:col-span-2" data-aos="fade-up" data-aos-delay="{% widthratio forloop.counter 1 100 %}">
            <div class="clay-card p-10 h-full relative overflow-hidden group cursor-pointer bg-[#E0E5EC] focus:ring-4 focus:ring-purple-300 focus:outline-none rounded-3xl product-card"
                role="button" tabindex="0" data-product-id="{{ product.id }}"
                data-external-url="{{ product.external_url|default:'' }}">

                <div class="flex items-center justify-between h-full relative z-10">
                    <div>
                        <div class="flex items-center gap-3 mb-2">
                            {% if "fa-" in product.icon %}
                            <i class="{{ product.icon }} text-purple-500 text-3xl"></i>
                            {% else %}
                            <span class="text-3xl">{{ product.icon }}</span>
                            {% endif %}
                            <h3 class="text-4xl font-bold text-gray-700 mt-1">{{ product.title }}</h3>
                        </div>
                        <p class="text-2xl text-gray-500 font-hand leading-tight">{{
                            product.lead_text|default:product.description }}</p>
                    </div>
                    <div
                        class="text-7xl text-purple-200/50 group-hover:text-purple-300/50 transition-colors absolute right-0 bottom-0">
                        {% if "fa-" in product.icon %}
                        <i class="fa-solid fa-magnifying-glass-plus"></i>
                        {% else %}
                        <span>{{ product.icon }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        {% elif product.card_size == "tall" %}
        <!-- Tall Card (1 column, 2 rows) -->
        <div class="md:row-span-2" data-aos="fade-up" data-aos-delay="{% widthratio forloop.counter 1 100 %}">
            <div class="clay-card h-full p-8 {% if product.color_theme == 'dark' %}bg-gray-800 text-white{% else %}bg-[#E0E5EC]{% endif %} group cursor-pointer relative overflow-hidden focus:ring-4 focus:ring-purple-300 focus:outline-none rounded-3xl product-card"
                role="button" tabindex="0" data-product-id="{{ product.id }}"
                data-external-url="{{ product.external_url|default:'' }}">

                <div class="relative z-10 flex flex-col h-full justify-between">
                    <div>
                        <span
                            class="{% if product.color_theme == 'dark' %}text-blue-300{% else %}text-purple-600{% endif %} font-bold text-lg tracking-wider uppercase mb-2 block">
                            {{ product.service_type|title }}
                        </span>
                        <h3 class="text-5xl font-bold mb-4 leading-tight mt-2">{{ product.title }}</h3>
                        <p
                            class="{% if product.color_theme == 'dark' %}text-gray-400{% else %}text-gray-600{% endif %} text-2xl leading-tight">
                            {{ product.lead_text|default:product.description }}</p>
                    </div>
                    <div class="mt-4">
                        <span
                            class="inline-block border {% if product.color_theme == 'dark' %}border-gray-600 hover:bg-gray-700{% else %}border-gray-300 hover:bg-gray-100{% endif %} rounded-full px-5 py-2 text-lg transition-colors">
                            보러가기 &rarr;
                        </span>
                    </div>
                </div>
            </div>
        </div>

        {% else %}
        <!-- Small Card (default) -->
        <div data-aos="fade-up" data-aos-delay="{% widthratio forloop.counter 1 100 %}">
            <div class="clay-card p-8 h-full flex flex-col justify-between group cursor-pointer hover:bg-purple-50 transition-colors relative focus:ring-4 focus:ring-purple-300 focus:outline-none rounded-3xl product-card"
                role="button" tabindex="0" data-product-id="{{ product.id }}"
                data-external-url="{{ product.external_url|default:'' }}">

                <div
                    class="w-16 h-16 rounded-3xl bg-purple-100 flex items-center justify-center text-purple-500 text-3xl mb-4 shadow-sm">
                    {% if "fa-" in product.icon %}
                    <i class="{{ product.icon }}"></i>
                    {% else %}
                    {{ product.icon }}
                    {% endif %}
                </div>
                <div>
                    <h3 class="text-3xl font-bold text-gray-700 mb-1">{{ product.title }}</h3>
                    <p class="text-xl text-gray-500 leading-tight">{{
                        product.lead_text|default:product.description|truncatechars:100 }}</p>
                </div>
            </div>
        </div>
        {% endif %}
        {% endif %}
        {% endfor %}

        <!-- 7. [Info Card] Why Eduitit? -->
        <div class="md:col-span-2 clay-card p-8 h-full bg-gradient-to-br from-blue-50 to-purple-50" data-aos="fade-up"
            data-aos-delay="700">
            <h3 class="text-3xl font-bold text-gray-700 mb-6">왜 EDUITIT인가요?</h3>
            <div class="grid grid-cols-2 gap-4">
                <div class="flex items-center gap-3">
                    <i class="fa-solid fa-check-circle text-green-500 text-2xl"></i>
                    <span class="text-gray-600 font-bold text-2xl pt-1">100% 무료</span>
                </div>
                <div class="flex items-center gap-3">
                    <i class="fa-solid fa-bolt text-yellow-500 text-2xl"></i>
                    <span class="text-gray-600 font-bold text-2xl pt-1">설치 불필요</span>
                </div>
                <div class="flex items-center gap-3">
                    <i class="fa-solid fa-wand-magic-sparkles text-purple-500 text-2xl"></i>
                    <span class="text-gray-600 font-bold text-2xl pt-1">스마트한 AI 비서</span>
                </div>
                <div class="flex items-center gap-3">
                    <i class="fa-solid fa-heart text-pink-500 text-2xl"></i>
                    <span class="text-gray-600 font-bold text-2xl pt-1">현직 교사 제작</span>
                </div>
            </div>
        </div>

        <!-- 8. [Contact Card] Feedback -->
        <div class="md:col-span-2 clay-card p-8 h-full flex flex-col sm:flex-row items-center justify-between gap-4 group bg-[#E0E5EC]"
            data-aos="fade-up" data-aos-delay="800">
            <div>
                <h3 class="text-3xl font-bold text-gray-700 mb-1">아이디어 제안하기</h3>
                <p class="text-gray-500 font-hand text-2xl">선생님께 필요한 도구를 만들어드려요.</p>
            </div>
            <a href="mailto:kakio@naver.com"
                class="clay-card px-8 py-3 text-purple-600 font-bold text-2xl hover:text-purple-700 transition-all flex items-center gap-2 shadow-clay hover:shadow-clay-hover">
                <i class="fa-regular fa-envelope"></i> <span class="hidden sm:inline">보내기</span>
            </a>
        </div>

    </div> <!-- End Bento Grid -->
</main>

<script>
    /**
     * Handle Card Clicks & Accessibility
     */
    document.addEventListener('DOMContentLoaded', () => {
        const cards = document.querySelectorAll('.product-card');
        cards.forEach(card => {
            const productId = card.getAttribute('data-product-id');

            // Click listener - Always open modal first
            card.addEventListener('click', () => {
                if (typeof openModal === 'function') {
                    openModal(productId);
                } else {
                    console.error('Core modal system (openModal) not found!');
                }
            });

            // Accessibility listener
            card.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    card.click();
                }
            });
        });
    });
</script>
{% endblock %}