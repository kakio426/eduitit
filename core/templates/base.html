<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Eduitit - 선생님의 업무 효율을 높여주는 스마트한 AI 도구 모음">
    <meta property="og:title" content="Eduitit - 선생님의 스마트한 하루">
    <meta property="og:description" content="AI 프롬프트 레시피, 도구 가이드, 교육용 게임까지. 교실에서의 혁신을 지금 시작하세요.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://eduitit.coding.io">
    <meta property="og:image" content="https://placehold.co/1200x630/purple/white?text=Eduitit+AI+for+Teachers">
    <meta name="twitter:card" content="summary_large_image">
    <title>{% block title %}Eduitit - 선생님의 스마트한 하루{% endblock %}</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Dongle:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bg-soft': '#E0E5EC',
                        'clay-text': '#4A5568',
                    },
                    fontFamily: {
                        'round': ['Dongle', 'sans-serif'],
                        'hand': ['Dongle', 'sans-serif'],
                    },
                    boxShadow: {
                        'clay': '9px 9px 16px rgb(163,177,198,0.6), -9px -9px 16px rgba(255,255,255, 0.5)',
                        'clay-inner': 'inset 6px 6px 10px 0 rgba(163,177,198, 0.7), inset -6px -6px 10px 0 rgba(255,255,255, 0.8)',
                        'clay-hover': '12px 12px 20px rgb(163,177,198,0.7), -12px -12px 20px rgba(255,255,255, 0.6)',
                    },
                    borderRadius: {
                        'clay': '30px',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #E0E5EC;
            color: #4A5568;
            font-family: 'Dongle', sans-serif;
            font-size: 1.5rem;
            /* Base font size increase for Dongle font */
        }

        /* Bento Grid Layout */
        .bento-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-auto-rows: minmax(200px, auto);
            gap: 1.5rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .bento-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .bento-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Spans */
        .col-span-2 {
            grid-column: span 2;
        }

        .col-span-4 {
            grid-column: span 4;
        }

        .row-span-2 {
            grid-row: span 2;
        }

        /* Card Styles */
        .clay-card {
            background-color: #E0E5EC;
            border-radius: 30px;
            box-shadow: 9px 9px 16px rgb(163, 177, 198, 0.6), -9px -9px 16px rgba(255, 255, 255, 0.5);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .clay-card:hover {
            transform: translateY(-5px) scale(1.01);
            box-shadow: 12px 12px 24px rgba(163, 177, 198, 0.8), -12px -12px 24px rgba(255, 255, 255, 0.7);
            z-index: 10;
        }

        .shadow-clay-inner {
            box-shadow: inset 6px 6px 10px 0 rgba(163, 177, 198, 0.7), inset -6px -6px 10px 0 rgba(255, 255, 255, 0.8);
        }

        /* Animations */
        .float-icon {
            animation: float 4s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>

<body class="selection:bg-purple-200">

    <!-- Navbar -->
    <nav class="fixed w-full z-50 top-0 left-0 px-6 py-4">
        <div
            class="max-w-7xl mx-auto clay-card px-6 py-3 flex justify-between items-center bg-[#E0E5EC]/90 backdrop-blur-sm">
            <div class="flex items-center gap-3">
                <div
                    class="w-12 h-12 rounded-full shadow-clay-inner flex items-center justify-center text-purple-500 text-2xl">
                    <i class="fa-solid fa-cloud"></i>
                </div>
                <a href="/" class="font-bold text-4xl text-gray-700 mt-2 hover:text-purple-600 transition">EDUITIT</a>
            </div>
            <!-- Desktop Navigation -->
            <div class="hidden md:flex gap-8 mt-2 text-2xl font-bold text-gray-500">
                <a href="/#services" class="hover:text-purple-600 transition">서비스</a>
                <a href="{% url 'portfolio:list' %}" class="hover:text-purple-600 transition">포트폴리오</a>
                {% if user.is_authenticated %}
                <a href="{% url 'sso_schoolit' %}"
                    class="hover:text-blue-600 transition flex items-center gap-2 px-4 py-1.5 rounded-full shadow-clay text-blue-600 font-bold bg-[#E0E5EC] hover:shadow-clay-hover">
                    <i class="fa-solid fa-graduation-cap text-xl"></i> 스쿨잇 이동
                </a>
                <a href="{% url 'dashboard' %}" class="hover:text-purple-600 transition flex items-center gap-2">
                    <i class="fa-solid fa-gauge-high text-xl"></i> 대시보드
                </a>
                <form action="{% url 'logout' %}" method="post" class="inline">
                    {% csrf_token %}
                    <button type="submit"
                        class="hover:text-red-500 transition px-4 py-1.5 rounded-full shadow-clay-inner text-xl font-bold bg-[#E0E5EC]/50 hover:bg-red-50">
                        <i class="fa-solid fa-arrow-right-from-bracket mr-1"></i> 로그아웃
                    </button>
                </form>
                {% else %}
                <a href="{% url 'login' %}"
                    class="hover:text-purple-600 transition px-5 py-1.5 rounded-full shadow-clay text-purple-600 font-bold bg-[#E0E5EC] hover:shadow-clay-hover">
                    <i class="fa-solid fa-user-lock mr-1"></i> 로그인
                </a>
                {% endif %}
            </div>

            <!-- Mobile Hamburger Button -->
            <button id="mobileMenuBtn" onclick="toggleMobileMenu()"
                class="md:hidden w-12 h-12 rounded-full shadow-clay-inner flex items-center justify-center text-gray-500 hover:text-purple-600 transition"
                aria-label="메뉴 열기" aria-expanded="false" aria-controls="mobileMenu">
                <i class="fa-solid fa-bars text-xl" id="menuIcon"></i>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu Panel -->
    <div id="mobileMenu"
        class="fixed inset-x-0 top-[88px] z-40 md:hidden transform -translate-y-full opacity-0 transition-all duration-300 ease-in-out pointer-events-none"
        aria-hidden="true">
        <div class="mx-4 clay-card p-6 bg-[#E0E5EC]/95 backdrop-blur-sm">
            <div class="flex flex-col gap-4 text-2xl font-bold text-gray-600">
                <a href="/#services" class="hover:text-purple-600 transition py-2 border-b border-gray-200/50">
                    <i class="fa-solid fa-grid-2 mr-3 text-purple-400"></i> 서비스
                </a>
                <a href="{% url 'portfolio:list' %}"
                    class="hover:text-purple-600 transition py-2 border-b border-gray-200/50">
                    <i class="fa-solid fa-briefcase mr-3 text-blue-400"></i> 포트폴리오
                </a>
                {% if user.is_authenticated %}
                <a href="{% url 'sso_schoolit' %}"
                    class="hover:text-blue-600 transition py-2 border-b border-gray-200/50">
                    <i class="fa-solid fa-graduation-cap mr-3 text-blue-400"></i> 스쿨잇 이동 (SSO)
                </a>
                <a href="{% url 'dashboard' %}"
                    class="hover:text-purple-600 transition py-2 border-b border-gray-200/50">
                    <i class="fa-solid fa-gauge-high mr-3 text-green-400"></i> 대시보드
                </a>
                <form action="{% url 'logout' %}" method="post" class="py-2">
                    {% csrf_token %}
                    <button type="submit" class="w-full text-left text-red-500 hover:text-red-600 transition">
                        <i class="fa-solid fa-arrow-right-from-bracket mr-3"></i> 로그아웃
                    </button>
                </form>
                {% else %}
                <a href="{% url 'login' %}"
                    class="py-3 mt-2 text-center rounded-full shadow-clay text-purple-600 hover:shadow-clay-hover transition">
                    <i class="fa-solid fa-user-lock mr-2"></i> 로그인
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    {% block content %}{% endblock %}

    <!-- Footer -->
    <footer class="py-12 text-center text-gray-400">
        <p class="text-2xl font-hand">선생님의 칼퇴를 응원합니다. © 2026 Eduitit</p>
    </footer>

    <!-- Unified Modal for All Product Previews -->
    <div id="unifiedModal" class="fixed inset-0 z-[100] hidden" aria-labelledby="modal-title" role="dialog"
        aria-modal="true">
        <!-- Backdrop -->
        <div class="fixed inset-0 bg-gray-500/20 backdrop-blur-md transition-opacity duration-300 opacity-0"
            id="modalBackdrop" aria-hidden="true" onclick="closeModal()"></div>

        <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
            <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-[3rem] bg-white/90 backdrop-blur-2xl text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-4xl border-2 border-white/50 scale-95 opacity-0 duration-300"
                    id="modalPanel">

                    <!-- Loading Spinner Overlay -->
                    <div id="modalLoading"
                        class="absolute inset-0 z-20 flex items-center justify-center bg-white/50 hidden">
                        <div class="flex flex-col items-center gap-4">
                            <i class="fa-solid fa-circle-notch fa-spin text-5xl text-purple-500"></i>
                            <p class="text-xl font-bold text-gray-500">정보를 가져오는 중...</p>
                        </div>
                    </div>

                    <!-- Close Button (Top) -->
                    <button onclick="closeModal()"
                        class="absolute top-8 right-8 z-10 w-14 h-14 rounded-full bg-gray-100/80 hover:bg-white transition-all flex items-center justify-center text-gray-400 hover:text-gray-800 shadow-clay-sm hover:shadow-clay group"
                        aria-label="Close modal">
                        <i
                            class="fa-solid fa-xmark text-2xl group-hover:rotate-90 transition-transform duration-300"></i>
                    </button>

                    <div id="modalContent" class="p-10 md:p-14 min-h-[400px]">
                        <!-- Content will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            const btn = document.getElementById('mobileMenuBtn');
            const icon = document.getElementById('menuIcon');
            const isOpen = menu.classList.contains('translate-y-0');

            if (isOpen) {
                // Close menu
                menu.classList.remove('translate-y-0', 'opacity-100', 'pointer-events-auto');
                menu.classList.add('-translate-y-full', 'opacity-0', 'pointer-events-none');
                menu.setAttribute('aria-hidden', 'true');
                btn.setAttribute('aria-expanded', 'false');
                btn.setAttribute('aria-label', '메뉴 열기');
                icon.classList.remove('fa-xmark');
                icon.classList.add('fa-bars');
                document.body.style.overflow = 'auto';
            } else {
                // Open menu
                menu.classList.remove('-translate-y-full', 'opacity-0', 'pointer-events-none');
                menu.classList.add('translate-y-0', 'opacity-100', 'pointer-events-auto');
                menu.setAttribute('aria-hidden', 'false');
                btn.setAttribute('aria-expanded', 'true');
                btn.setAttribute('aria-label', '메뉴 닫기');
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-xmark');
                document.body.style.overflow = 'hidden';
            }
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function (e) {
            const menu = document.getElementById('mobileMenu');
            const btn = document.getElementById('mobileMenuBtn');
            if (menu && !menu.contains(e.target) && !btn.contains(e.target)) {
                if (menu.classList.contains('translate-y-0')) {
                    toggleMobileMenu();
                }
            }
        });

        // Close mobile menu on resize to desktop
        window.addEventListener('resize', function () {
            const menu = document.getElementById('mobileMenu');
            if (window.innerWidth >= 768 && menu && menu.classList.contains('translate-y-0')) {
                toggleMobileMenu();
            }
        });

        function openModal(productId) {
            const modal = document.getElementById('unifiedModal');
            const backdrop = document.getElementById('modalBackdrop');
            const panel = document.getElementById('modalPanel');
            const content = document.getElementById('modalContent');
            const loading = document.getElementById('modalLoading');
            const body = document.body;

            // Show modal and prevent scroll
            modal.classList.remove('hidden');
            body.style.overflow = 'hidden';

            // Reset scale for animation
            panel.classList.add('scale-95', 'opacity-0');

            // Animate in
            requestAnimationFrame(() => {
                backdrop.classList.remove('opacity-0');
                panel.classList.remove('scale-95', 'opacity-0');
                panel.classList.add('scale-100', 'opacity-100');
            });

            // Show loading
            loading.classList.remove('hidden');
            content.innerHTML = '';

            // Load content
            fetch(`/products/preview/${productId}/?t=${Date.now()}`)
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.text();
                })
                .then(html => {
                    content.innerHTML = html;
                    loading.classList.add('hidden');
                })
                .catch(error => {
                    console.error('Error loading modal content:', error);
                    content.innerHTML = `
                        <div class="flex flex-col items-center justify-center py-20 text-center space-y-6">
                            <i class="fa-solid fa-triangle-exclamation text-7xl text-gray-200"></i>
                            <h3 class="text-3xl font-bold text-gray-700">정보를 불러오지 못했습니다</h3>
                            <p class="text-xl text-gray-400 font-hand">잠시 후 다시 시도해 주세요.</p>
                            <button onclick="openModal(${productId})" class="px-8 py-3 bg-purple-500 text-white rounded-full font-bold shadow-clay hover:scale-105 transition">다시 시도</button>
                        </div>
                    `;
                    loading.classList.add('hidden');
                });
        }

        function closeModal() {
            const modal = document.getElementById('unifiedModal');
            const backdrop = document.getElementById('modalBackdrop');
            const panel = document.getElementById('modalPanel');
            const body = document.body;

            // Animate out
            backdrop.classList.add('opacity-0');
            panel.classList.remove('scale-100', 'opacity-100');
            panel.classList.add('scale-95', 'opacity-0');

            setTimeout(() => {
                modal.classList.add('hidden');
                body.style.overflow = 'auto';
            }, 300);
        }

        // Close on escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape' && !document.getElementById('unifiedModal').classList.contains('hidden')) {
                closeModal();
            }
        });

        // Prevent clicks inside modal from closing it
        document.addEventListener('DOMContentLoaded', function () {
            const panel = document.getElementById('modalPanel');
            if (panel) {
                panel.addEventListener('click', function (e) {
                    e.stopPropagation();
                });
            }
        });
    </script>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Initialize Animate On Scroll
        AOS.init({
            once: true,
            offset: 50,
            duration: 800,
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>

</html>