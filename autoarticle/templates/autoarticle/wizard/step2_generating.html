{% extends 'autoarticle/wizard/base_wizard.html' %}
{% block wizard_content %}
<!-- Modal Backdrop -->
<div class='fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center' id='loadingModal'>
    <!-- Modal Content -->
    <div class='clay-card p-12 bg-white shadow-2xl rounded-[3rem] text-center max-w-md mx-4 animate-fade-in'>
        <!-- Animated Icon -->
        <div class='mb-6 text-7xl animate-bounce-slow'>
            ✍️
        </div>

        <!-- Creative Loading Message -->
        <h3 class='text-3xl font-bold text-gray-800 mb-4 font-display' id='loadingMessage'>
            베테랑 기자 AI가 열심히 취재 중이에요
        </h3>

        <!-- Subtext -->
        <p class='text-lg text-gray-500 font-hand mb-6'>
            잠시만 기다려주세요
        </p>

        <!-- Progress Dots -->
        <div class='flex justify-center gap-2'>
            <div class='w-3 h-3 bg-purple-500 rounded-full animate-pulse' style='animation-delay: 0s'></div>
            <div class='w-3 h-3 bg-purple-500 rounded-full animate-pulse' style='animation-delay: 0.2s'></div>
            <div class='w-3 h-3 bg-purple-500 rounded-full animate-pulse' style='animation-delay: 0.4s'></div>
        </div>
    </div>
</div>

<form id='genForm' method='post' action='{% url "autoarticle:create" %}'>
    {% csrf_token %}
    <input type='hidden' name='step' value='2'>
</form>

<script>
    // Creative loading messages
    const messages = [
        '베테랑 기자 AI가 열심히 취재 중이에요',
        '현장의 생생함을 담아내고 있어요',
        '감동적인 문장을 고르고 있어요',
        '독자들이 좋아할 표현을 찾고 있어요',
        '마지막 퇴고 작업 중이에요'
    ];

    let messageIndex = 0;
    const messageElement = document.getElementById('loadingMessage');

    // Rotate messages every 2 seconds
    const messageInterval = setInterval(() => {
        messageIndex = (messageIndex + 1) % messages.length;
        messageElement.classList.add('opacity-0');
        setTimeout(() => {
            messageElement.textContent = messages[messageIndex];
            messageElement.classList.remove('opacity-0');
        }, 300);
    }, 2000);

    // Submit form after 500ms
    window.onload = function() {
        setTimeout(() => {
            clearInterval(messageInterval);
            document.getElementById("genForm").submit();
        }, 500);
    }
</script>

<style>
    @keyframes fade-in {
        from {
            opacity: 0;
            transform: scale(0.95);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    @keyframes bounce-slow {
        0%, 100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-10px);
        }
    }

    .animate-fade-in {
        animation: fade-in 0.3s ease-out;
    }

    .animate-bounce-slow {
        animation: bounce-slow 2s ease-in-out infinite;
    }

    #loadingMessage {
        transition: opacity 0.3s ease-in-out;
    }

    .clay-card {
        box-shadow: 20px 20px 60px #d1d9e6, -20px -20px 60px #ffffff;
    }
</style>
{% endblock %}